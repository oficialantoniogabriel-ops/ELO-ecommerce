<!DOCTYPE html>
<html lang="pt-AO">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel - ELO Commerce</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a2e0e6ad3b.js" crossorigin="anonymous"></script>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: "Poppins", sans-serif;
    }
    .navbar {
      background: linear-gradient(90deg, #b8860b, #000);
      padding: 12px;
    }
    .navbar-brand {
      font-weight: bold;
      color: #fff;
    }
    .sidebar {
      background-color: #111;
      padding-top: 20px;
      height: 100vh;
      position: fixed;
      width: 220px;
      border-right: 1px solid #222;
    }
    .sidebar a {
      color: #ffcc00;
      display: block;
      padding: 12px 20px;
      text-decoration: none;
      transition: 0.3s;
    }
    .sidebar a:hover {
      background-color: #b8860b;
      color: #000;
    }
    .content {
      margin-left: 230px;
      padding: 25px;
    }
    .btn-gold {
      background-color: #b8860b;
      border: none;
      color: #fff;
      border-radius: 20px;
      padding: 8px 16px;
      transition: 0.3s;
    }
    .btn-gold:hover {
      background-color: #ffcc00;
      color: #000;
    }
    .card {
      background-color: #111;
      border: 1px solid #222;
      color: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .card h5 {
      color: #ffcc00;
    }
    @media(max-width:768px){
      .sidebar {width:100%; height:auto; position:relative; display:flex; overflow-x:auto;}
      .sidebar a {flex:1; text-align:center;}
      .content {margin-left:0;}
    }
  </style>
</head>
<body>

<nav class="navbar navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand"><i class="fas fa-store"></i> ELO Commerce</a>
    <button id="logoutBtn" class="btn btn-outline-light">Sair</button>
  </div>
</nav>

<div class="sidebar">
  <a href="#" data-section="inicio"><i class="fas fa-home"></i> In√≠cio</a>
  <a href="#" data-section="produtos"><i class="fas fa-box"></i> Produtos</a>
  <a href="#" data-section="vendas"><i class="fas fa-shopping-cart"></i> Vendas</a>
  <a href="#" data-section="carteira"><i class="fas fa-wallet"></i> Carteira</a>
  <a href="#" data-section="afiliados"><i class="fas fa-users"></i> Afiliados</a>
  <a href="#" data-section="perfil"><i class="fas fa-user-circle"></i> Perfil</a>
</div>

<div class="content">
  <div id="conteudo">
    <h3 class="text-warning">Bem-vindo(a) √† sua loja ELO Commerce!</h3>
    <p>Gerencie seus produtos, acompanhe vendas e controle sua carteira aqui.</p>
  </div>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, collection, addDoc, getDocs, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAN_7vyt0XcOt6NvOE6MDoBCajUjhToCR0",
    authDomain: "elo-ecommerce-ecd87.firebaseapp.com",
    projectId: "elo-ecommerce-ecd87",
    storageBucket: "elo-ecommerce-ecd87.appspot.com",
    messagingSenderId: "375574231770",
    appId: "1:375574231770:web:78279cb6aac72c454703e3"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const conteudo = document.getElementById("conteudo");

  // üîπ Autentica√ß√£o
  onAuthStateChanged(auth, user => {
    if (!user) window.location.href = "login.html";
  });

  // üîπ Logout
  document.getElementById("logoutBtn").addEventListener("click", async () => {
    await signOut(auth);
    window.location.href = "login.html";
  });

  // üîπ Carregar se√ß√µes
  async function carregarSecao(sec) {
    if (sec === "inicio") {
      conteudo.innerHTML = `<h4 class='text-warning'>üìä Painel Geral</h4>
      <p>Veja um resumo das suas atividades na plataforma.</p>`;
    }

    // Produtos
    if (sec === "produtos") {
      conteudo.innerHTML = `
        <h4 class='text-warning mb-3'>üõçÔ∏è Seus Produtos</h4>
        <button class="btn-gold mb-3" id="novoProduto">+ Novo Produto</button>
        <div id="listaProdutos">Carregando produtos...</div>
      `;

      const snap = await getDocs(collection(db, "produtos"));
      let html = "";
      snap.forEach(docSnap => {
        const p = docSnap.data();
        html += `
          <div class="card">
            <h5>${p.nome}</h5>
            <img src="${p.imagem || 'https://via.placeholder.com/200'}" class="img-fluid rounded mb-2" width="150">
            <p>${p.descricao || 'Sem descri√ß√£o'}</p>
            <p><b>Pre√ßo:</b> ${p.preco || '0'} kz</p>
          </div>`;
      });
      document.getElementById("listaProdutos").innerHTML = html || "<p>Nenhum produto cadastrado.</p>";

      document.getElementById("novoProduto").addEventListener("click", () => {
        conteudo.innerHTML = `
          <h4 class='text-warning'>Adicionar Produto</h4>
          <form id="formProduto" class="mt-3">
            <input type="text" class="form-control mb-2" id="nome" placeholder="Nome do produto" required>
            <input type="text" class="form-control mb-2" id="descricao" placeholder="Descri√ß√£o">
            <input type="number" class="form-control mb-2" id="preco" placeholder="Pre√ßo em KZ" required>
            <input type="url" class="form-control mb-2" id="imagem" placeholder="URL da imagem (opcional)">
            <button type="submit" class="btn-gold">Salvar Produto</button>
          </form>`;
        
        document.getElementById("formProduto").addEventListener("submit", async (e) => {
          e.preventDefault();
          const user = auth.currentUser;
          await addDoc(collection(db, "produtos"), {
            nome: nome.value,
            descricao: descricao.value,
            preco: preco.value,
            imagem: imagem.value,
            vendedor: user.email
          });
          alert("‚úÖ Produto salvo com sucesso!");
          carregarSecao("produtos");
        });
      });
    }

    if (sec === "vendas") conteudo.innerHTML = "<p class='text-warning'>üõí Suas vendas aparecer√£o aqui.</p>";
    if (sec === "carteira") conteudo.innerHTML = "<p class='text-warning'>üí∞ Saldo atual: em breve real.</p>";
    if (sec === "afiliados") conteudo.innerHTML = "<p class='text-warning'>ü§ù Sistema de afiliados em breve.</p>";
    if (sec === "perfil") conteudo.innerHTML = "<p class='text-warning'>üë§ Atualize suas informa√ß√µes de perfil em breve.</p>";
  }

  // Sidebar
  document.querySelectorAll(".sidebar a").forEach(link => {
    link.addEventListener("click", e => {
      e.preventDefault();
      carregarSecao(link.getAttribute("data-section"));
    });
  });
</script>

</body>
  </html>
