<!DOCTYPE html>
<html lang="pt-AO">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel do Usu√°rio - ELO Commerce</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {background:#000;color:#fff;font-family:"Poppins",sans-serif;}
    .navbar{background:linear-gradient(90deg,#b8860b 0%,#000 100%);}
    .navbar-brand{color:#fff!important;font-weight:700;}
    .btn-gold{background:#b8860b;color:#fff;border:none;border-radius:20px;padding:8px 16px;transition:.3s;}
    .btn-gold:hover{background:#ffcc00;color:#000;}
    .sidebar{position:fixed;top:56px;left:0;width:220px;height:100%;background:#111;border-right:1px solid #222;padding-top:20px;}
    .sidebar a{display:block;padding:10px 20px;color:#ffcc00;text-decoration:none;transition:.3s;}
    .sidebar a:hover{background:#b8860b;color:#000;}
    .content{margin-left:230px;padding:30px;}
    table{color:#fff;}
    table th{color:#ffcc00;}
    .card{background:#111;border:1px solid #222;border-radius:10px;padding:15px;}
  </style>
</head>
<body>

<nav class="navbar navbar-dark fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand">‚öúÔ∏è Painel do Usu√°rio</a>
    <div>
      <button id="homeBtn" class="btn btn-outline-light me-2">üè† In√≠cio</button>
      <button id="logoutBtn" class="btn btn-outline-light">Sair</button>
    </div>
  </div>
</nav>

<div class="sidebar">
  <a href="#" data-section="perfil">üë§ Perfil</a>
  <a href="#" data-section="produtos">üõçÔ∏è Meus Produtos</a>
  <a href="#" data-section="vendas">üí∏ Minhas Vendas</a>
  <a href="#" data-section="carteira">üí∞ Carteira</a>
  <a href="#" data-section="afiliados">ü§ù Afiliados</a>
  <a href="#" data-section="planos">üì¶ Planos</a>
</div>

<div class="content">
  <h2 class="text-warning mb-4">Bem-vindo ao seu painel</h2>
  <div id="conteudo">
    <p>Selecione uma op√ß√£o na barra lateral.</p>
  </div>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, getDocs, addDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAN_7vyt0XcOt6NvOE6MDoBCajUjhToCR0",
    authDomain: "elo-ecommerce-ecd87.firebaseapp.com",
    projectId: "elo-ecommerce-ecd87",
    storageBucket: "elo-ecommerce-ecd87.appspot.com",
    messagingSenderId: "375574231770",
    appId: "1:375574231770:web:78279cb6aac72c454703e3"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);
  const conteudo = document.getElementById("conteudo");

  // Autentica√ß√£o
  onAuthStateChanged(auth, async (user) => {
    if (!user) window.location.href = "login.html";
    else carregarPerfil(user.email);
  });

  document.getElementById("logoutBtn").addEventListener("click", async ()=>{
    await signOut(auth);
    window.location.href = "login.html";
  });
  document.getElementById("homeBtn").addEventListener("click", ()=> window.location.href="index.html");

  // Se√ß√µes
  document.querySelectorAll(".sidebar a").forEach(link=>{
    link.addEventListener("click", e=>{
      e.preventDefault();
      const sec = link.getAttribute("data-section");
      if(sec==="perfil") mostrarPerfil();
      if(sec==="produtos") mostrarProdutos();
      if(sec==="vendas") mostrarVendas();
      if(sec==="carteira") mostrarCarteira();
      if(sec==="afiliados") mostrarAfiliados();
      if(sec==="planos") mostrarPlanos();
    });
  });

  // ---------------- SE√á√ÉO PERFIL ----------------
  async function carregarPerfil(email){
    const snap = await getDoc(doc(db,"usuarios",email));
    if(snap.exists()){
      const d = snap.data();
      conteudo.innerHTML = `
        <div class='card text-center'>
          <img src='${d.foto || "https://via.placeholder.com/100"}' class='rounded-circle mb-3' width='100'>
          <h4>${d.nome || "Usu√°rio"}</h4>
          <p>${d.bio || ""}</p>
          <input type='file' id='fotoInput' class='form-control mb-2' accept='image/*'>
          <textarea id='bioInput' class='form-control mb-2' placeholder='Sua bio...'>${d.bio||""}</textarea>
          <button class='btn-gold' id='salvarPerfil'>Salvar</button>
        </div>`;
      document.getElementById("salvarPerfil").onclick = ()=>salvarPerfil(email);
    }
  }

  async function salvarPerfil(email){
    const file = document.getElementById("fotoInput").files[0];
    const bio = document.getElementById("bioInput").value;
    let fotoURL="";
    if(file){
      const fileRef = ref(storage, "usuarios/"+email+".jpg");
      await uploadBytes(fileRef,file);
      fotoURL = await getDownloadURL(fileRef);
    }
    await updateDoc(doc(db,"usuarios",email),{bio:bio,foto:fotoURL});
    alert("Perfil atualizado!");
  }

  // ---------------- SE√á√ÉO PRODUTOS ----------------
  async function mostrarProdutos(){
    conteudo.innerHTML = `
      <div class='card'>
        <h4 class='text-warning mb-3'>Adicionar Produto</h4>
        <input id='nomeProd' class='form-control mb-2' placeholder='Nome do produto'>
        <textarea id='descProd' class='form-control mb-2' placeholder='Descri√ß√£o'></textarea>
        <input id='precoProd' class='form-control mb-2' placeholder='Pre√ßo (Kz ou USD)'>
        <select id='tipoProd' class='form-control mb-2'>
          <option value='fisico'>F√≠sico</option>
          <option value='digital'>Digital</option>
        </select>
        <input type='file' id='fotoProd' accept='image/*,video/*' class='form-control mb-2'>
        <button class='btn-gold' id='btnSalvarProd'>Salvar Produto</button>
      </div>`;
    document.getElementById("btnSalvarProd").onclick = salvarProduto;
  }

  async function salvarProduto(){
    const user = auth.currentUser;
    const nome = nomeProd.value, desc = descProd.value, preco = precoProd.value, tipo = tipoProd.value;
    const file = fotoProd.files[0];
    let midiaURL="";
    if(file){
      const fileRef = ref(storage, "produtos/"+user.uid+"/"+file.name);
      await uploadBytes(fileRef,file);
      midiaURL = await getDownloadURL(fileRef);
    }
    await addDoc(collection(db,"produtos"),{
      vendedor:user.email, nome, desc, preco, tipo, midia:midiaURL, criadoEm:new Date()
    });
    alert("Produto adicionado!");
  }

  // ---------------- SE√á√ÉO VENDAS ----------------
  async function mostrarVendas(){
    conteudo.innerHTML="<p class='text-warning'>Carregando vendas...</p>";
    const snap = await getDocs(collection(db,"vendas"));
    if(snap.empty){conteudo.innerHTML="<p>Nenhuma venda registrada.</p>";return;}
    let html="<table class='table'><thead><tr><th>Produto</th><th>Comprador</th><th>Valor</th></tr></thead><tbody>";
    snap.forEach(d=>{const v=d.data();html+=`<tr><td>${v.produto}</td><td>${v.comprador}</td><td>${v.valor}</td></tr>`});
    conteudo.innerHTML=html+"</tbody></table>";
  }

  // ---------------- SE√á√ÉO CARTEIRA ----------------
  async function mostrarCarteira(){
    conteudo.innerHTML=`
      <div class='card text-center'>
        <h4 class='text-warning'>Carteira</h4>
        <p>Saldo: <strong id='saldoValor'>Carregando...</strong></p>
        <button class='btn-gold mb-2' id='addFunds'>Adicionar Fundos</button>
        <button class='btn-gold mb-2' id='sacar'>Sacar</button>
      </div>`;
    document.getElementById("addFunds").onclick=()=>alert("Fun√ß√£o PayPal em implementa√ß√£o real.");
    document.getElementById("sacar").onclick=()=>alert("Saque solicitado!");
  }

  // ---------------- SE√á√ÉO AFILIADOS ----------------
  async function mostrarAfiliados(){
    const user=auth.currentUser;
    conteudo.innerHTML=`
      <div class='card text-center'>
        <h4 class='text-warning'>Programa de Afiliados</h4>
        <p>Compartilhe seu link e ganhe 10% por venda.</p>
        <p><input class='form-control' readonly value='https://elo-commerce.com/?ref=${user.email}'></p>
      </div>`;
  }

  // ---------------- SE√á√ÉO PLANOS ----------------
  async function mostrarPlanos(){
    conteudo.innerHTML=`
      <div class='text-center'>
        <h3 class='text-warning mb-3'>Assine o Plano Premium</h3>
        <p>Tenha loja ilimitada e destaque autom√°tico por apenas <strong>10 USD/m√™s</strong>.</p>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
          <input type="hidden" name="cmd" value="_xclick">
          <input type="hidden" name="business" value="oficialelo270@gmail.com">
          <input type="hidden" name="item_name" value="Plano Premium ELO Commerce">
          <input type="hidden" name="currency_code" value="USD">
          <input type="hidden" name="amount" value="10.00">
          <button class='btn-gold'>Assinar via PayPal</button>
        </form>
      </div>`;
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
  </html><!DOCTYPE html>
<html lang="pt-AO">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel do Usu√°rio - ELO Commerce</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {background:#000;color:#fff;font-family:"Poppins",sans-serif;}
    .navbar{background:linear-gradient(90deg,#b8860b 0%,#000 100%);}
    .navbar-brand{color:#fff!important;font-weight:700;}
    .btn-gold{background:#b8860b;color:#fff;border:none;border-radius:20px;padding:8px 16px;transition:.3s;}
    .btn-gold:hover{background:#ffcc00;color:#000;}
    .sidebar{position:fixed;top:56px;left:0;width:220px;height:100%;background:#111;border-right:1px solid #222;padding-top:20px;}
    .sidebar a{display:block;padding:10px 20px;color:#ffcc00;text-decoration:none;transition:.3s;}
    .sidebar a:hover{background:#b8860b;color:#000;}
    .content{margin-left:230px;padding:30px;}
    table{color:#fff;}
    table th{color:#ffcc00;}
    .card{background:#111;border:1px solid #222;border-radius:10px;padding:15px;}
  </style>
</head>
<body>

<nav class="navbar navbar-dark fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand">‚öúÔ∏è Painel do Usu√°rio</a>
    <div>
      <button id="homeBtn" class="btn btn-outline-light me-2">üè† In√≠cio</button>
      <button id="logoutBtn" class="btn btn-outline-light">Sair</button>
    </div>
  </div>
</nav>

<div class="sidebar">
  <a href="#" data-section="perfil">üë§ Perfil</a>
  <a href="#" data-section="produtos">üõçÔ∏è Meus Produtos</a>
  <a href="#" data-section="vendas">üí∏ Minhas Vendas</a>
  <a href="#" data-section="carteira">üí∞ Carteira</a>
  <a href="#" data-section="afiliados">ü§ù Afiliados</a>
  <a href="#" data-section="planos">üì¶ Planos</a>
</div>

<div class="content">
  <h2 class="text-warning mb-4">Bem-vindo ao seu painel</h2>
  <div id="conteudo">
    <p>Selecione uma op√ß√£o na barra lateral.</p>
  </div>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, getDocs, addDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAN_7vyt0XcOt6NvOE6MDoBCajUjhToCR0",
    authDomain: "elo-ecommerce-ecd87.firebaseapp.com",
    projectId: "elo-ecommerce-ecd87",
    storageBucket: "elo-ecommerce-ecd87.appspot.com",
    messagingSenderId: "375574231770",
    appId: "1:375574231770:web:78279cb6aac72c454703e3"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);
  const conteudo = document.getElementById("conteudo");

  // Autentica√ß√£o
  onAuthStateChanged(auth, async (user) => {
    if (!user) window.location.href = "login.html";
    else carregarPerfil(user.email);
  });

  document.getElementById("logoutBtn").addEventListener("click", async ()=>{
    await signOut(auth);
    window.location.href = "login.html";
  });
  document.getElementById("homeBtn").addEventListener("click", ()=> window.location.href="index.html");

  // Se√ß√µes
  document.querySelectorAll(".sidebar a").forEach(link=>{
    link.addEventListener("click", e=>{
      e.preventDefault();
      const sec = link.getAttribute("data-section");
      if(sec==="perfil") mostrarPerfil();
      if(sec==="produtos") mostrarProdutos();
      if(sec==="vendas") mostrarVendas();
      if(sec==="carteira") mostrarCarteira();
      if(sec==="afiliados") mostrarAfiliados();
      if(sec==="planos") mostrarPlanos();
    });
  });

  // ---------------- SE√á√ÉO PERFIL ----------------
  async function carregarPerfil(email){
    const snap = await getDoc(doc(db,"usuarios",email));
    if(snap.exists()){
      const d = snap.data();
      conteudo.innerHTML = `
        <div class='card text-center'>
          <img src='${d.foto || "https://via.placeholder.com/100"}' class='rounded-circle mb-3' width='100'>
          <h4>${d.nome || "Usu√°rio"}</h4>
          <p>${d.bio || ""}</p>
          <input type='file' id='fotoInput' class='form-control mb-2' accept='image/*'>
          <textarea id='bioInput' class='form-control mb-2' placeholder='Sua bio...'>${d.bio||""}</textarea>
          <button class='btn-gold' id='salvarPerfil'>Salvar</button>
        </div>`;
      document.getElementById("salvarPerfil").onclick = ()=>salvarPerfil(email);
    }
  }

  async function salvarPerfil(email){
    const file = document.getElementById("fotoInput").files[0];
    const bio = document.getElementById("bioInput").value;
    let fotoURL="";
    if(file){
      const fileRef = ref(storage, "usuarios/"+email+".jpg");
      await uploadBytes(fileRef,file);
      fotoURL = await getDownloadURL(fileRef);
    }
    await updateDoc(doc(db,"usuarios",email),{bio:bio,foto:fotoURL});
    alert("Perfil atualizado!");
  }

  // ---------------- SE√á√ÉO PRODUTOS ----------------
  async function mostrarProdutos(){
    conteudo.innerHTML = `
      <div class='card'>
        <h4 class='text-warning mb-3'>Adicionar Produto</h4>
        <input id='nomeProd' class='form-control mb-2' placeholder='Nome do produto'>
        <textarea id='descProd' class='form-control mb-2' placeholder='Descri√ß√£o'></textarea>
        <input id='precoProd' class='form-control mb-2' placeholder='Pre√ßo (Kz ou USD)'>
        <select id='tipoProd' class='form-control mb-2'>
          <option value='fisico'>F√≠sico</option>
          <option value='digital'>Digital</option>
        </select>
        <input type='file' id='fotoProd' accept='image/*,video/*' class='form-control mb-2'>
        <button class='btn-gold' id='btnSalvarProd'>Salvar Produto</button>
      </div>`;
    document.getElementById("btnSalvarProd").onclick = salvarProduto;
  }

  async function salvarProduto(){
    const user = auth.currentUser;
    const nome = nomeProd.value, desc = descProd.value, preco = precoProd.value, tipo = tipoProd.value;
    const file = fotoProd.files[0];
    let midiaURL="";
    if(file){
      const fileRef = ref(storage, "produtos/"+user.uid+"/"+file.name);
      await uploadBytes(fileRef,file);
      midiaURL = await getDownloadURL(fileRef);
    }
    await addDoc(collection(db,"produtos"),{
      vendedor:user.email, nome, desc, preco, tipo, midia:midiaURL, criadoEm:new Date()
    });
    alert("Produto adicionado!");
  }

  // ---------------- SE√á√ÉO VENDAS ----------------
  async function mostrarVendas(){
    conteudo.innerHTML="<p class='text-warning'>Carregando vendas...</p>";
    const snap = await getDocs(collection(db,"vendas"));
    if(snap.empty){conteudo.innerHTML="<p>Nenhuma venda registrada.</p>";return;}
    let html="<table class='table'><thead><tr><th>Produto</th><th>Comprador</th><th>Valor</th></tr></thead><tbody>";
    snap.forEach(d=>{const v=d.data();html+=`<tr><td>${v.produto}</td><td>${v.comprador}</td><td>${v.valor}</td></tr>`});
    conteudo.innerHTML=html+"</tbody></table>";
  }

  // ---------------- SE√á√ÉO CARTEIRA ----------------
  async function mostrarCarteira(){
    conteudo.innerHTML=`
      <div class='card text-center'>
        <h4 class='text-warning'>Carteira</h4>
        <p>Saldo: <strong id='saldoValor'>Carregando...</strong></p>
        <button class='btn-gold mb-2' id='addFunds'>Adicionar Fundos</button>
        <button class='btn-gold mb-2' id='sacar'>Sacar</button>
      </div>`;
    document.getElementById("addFunds").onclick=()=>alert("Fun√ß√£o PayPal em implementa√ß√£o real.");
    document.getElementById("sacar").onclick=()=>alert("Saque solicitado!");
  }

  // ---------------- SE√á√ÉO AFILIADOS ----------------
  async function mostrarAfiliados(){
    const user=auth.currentUser;
    conteudo.innerHTML=`
      <div class='card text-center'>
        <h4 class='text-warning'>Programa de Afiliados</h4>
        <p>Compartilhe seu link e ganhe 10% por venda.</p>
        <p><input class='form-control' readonly value='https://elo-commerce.com/?ref=${user.email}'></p>
      </div>`;
  }

  // ---------------- SE√á√ÉO PLANOS ----------------
  async function mostrarPlanos(){
    conteudo.innerHTML=`
      <div class='text-center'>
        <h3 class='text-warning mb-3'>Assine o Plano Premium</h3>
        <p>Tenha loja ilimitada e destaque autom√°tico por apenas <strong>10 USD/m√™s</strong>.</p>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
          <input type="hidden" name="cmd" value="_xclick">
          <input type="hidden" name="business" value="oficialelo270@gmail.com">
          <input type="hidden" name="item_name" value="Plano Premium ELO Commerce">
          <input type="hidden" name="currency_code" value="USD">
          <input type="hidden" name="amount" value="10.00">
          <button class='btn-gold'>Assinar via PayPal</button>
        </form>
      </div>`;
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
  </html>
